<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css'>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" /> 
    <style>
        #open{
        display:none;
        }
        a.nav-link.py-3.px-2 {
    color: black;
}

    </style>
    </head>
    <body onload="load()">
        <nav class="navbar navbar-expand-lg navbar-light bg-dark text-white navbar-fixed fixed-top mb-10">
            <div class="container-fluid">
                <div class="col">
                    <a class="navbar-brand text-white" href="#"><i class='fa fa-home yellow-color pe-2 ps-2'></i>Hometel PG For Women</a>
                </div>
                <div class="col text-white">
                    <h4>Booking</h4>
               </div>
            </div>
        </nav>
        <div><h1>hh</h1></div>
        <div class="container-fluid mt-10 pt-10">
            <div class="row pt-10 mt-10">
                <div class="col-sm-auto bg-white">
                    <div>
                        <ul class="nav flex-sm-column text-center align-items-center">
                            <li>
                                <a href="dashboard.html" class="nav-link py-3 px-2">
                                    <i class='fa fa-dashboard pt-10'></i>
                                    <p>DashBoard</p>
                                </a>
                            </li>
                            <li>
                                <a href="userlist.html" class=" nav-link py-3 px-2">
                                    <i class='fa-solid fa-user-group'></i>
                                    <p>People</p>
                                </a>
                            </li>
                            <li>
                                <a href="index.html" class="nav-link py-3 px-2">
                                    <i class='fa fa-bed'></i>
                                    <p>Room</p>
                                </a>
                            </li>
                            <li>
                                <a href="paymentlist.html" class="nav-link py-3 px-2">  
                                 <i class='fa fa-money'></i>
                                    <p>Payment</p>
                                </a>
                            </li>
                            <li>
                                <a href="bookinglist.html" class="nav-link py-3 px-2">
                                    <i class='fa-solid fa-calendar-xmark'></i>
                                    <p>Booking</p>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm p-3 min-vh-100" style="background-color:#f3f6f9;">
                    <div id="open">
                     <div class="row pt-3 mb-5 text-center">
                         <div class="col-3"></div>
                         <div class="col-6 border-1 border-top border-bottom shadow border-info pt-2">
                             <form name="myForm">
                            <div class="row pt-3">


                                <div class="col-4">
                                    <label for="fname" class="form-label mb-0">
                                        <h6>Your First Name</h6>
                                    </label>
                                    <input type="text" class="form-control pe-2 mt-0" id="fname" placeholder="Your First Name">
                                </div>
                                <div class="col-4">
                                    <label for="lname" class="form-label mb-0">
                                        <h6>Your Last Name</h6>
                                    </label>
                                    <input type="text" class="form-control mt-0" id="lname" placeholder="Your Last Name">
                                </div>
                                <div class="col-4">

                                        <label for="email" class="form-label mb-0">
                                            <h6>Your Email</h6>
                                        </label>
                                        <input type="email" class="form-control mt-0" id="email" placeholder="henry@xyz.com">

                                </div>

                             </div>


                             <div class="row mt-5">
                                 <div class="col-4">
                                     <label for="mobileno" class="form-label mb-0">
                                       <h6>Your Mobile Number</h6>
                                     </label>
                                     <input type="text" class="form-control pe-2 mt-0" id="mobileno" placeholder="Mobile No">
                                   </div>

                                 <div class="col-4">
                                     <label for="demo" class="form-label mb-0 pb-0">Choose Room:</label>
                                     <p id="demo" class="mt-0 pt-0"></p>
                                     <select id="mySelect" class="form-select">
                                     </select>
                                 </div>
                                 <div class="col-4">
                                     <label for="dob" class="form-label mb-0">
                                         <h6>Your DOB</h6>
                                     </label>
                                     <input type="date" class="form-control mt-0" id="dob">
                                 </div>
                             </div>
                             <div class="text-center mt-4 mb-2">
                                <button type="button" class="btn btn-danger" onclick="bookRoom()">Book Room</button></div>
                             </form>
                           </div>
                         <div class="col-3"></div>
                     </div>
                    </div>
                    <div class="row">
                        <div class="col-10"></div>
                        <div class="col-2">
                            <button type="button" class="btn btn-danger" onclick="disp()">+ Add Booking</button></div>
                    </div>
                    <div class="row">
                        <div class="col-1"></div>
                        <div class="col">
                    <table class="table table-striped ps-3 pe-3 mt-5 shadow-lg border border-light  border-3">
                        <thead class="ps-3">
                          <tr>
                              <th scope="col">S.No</th>
                            <th scope="col">Email</th>
                            <th scope="col">Room No</th>
                            <th scope="col">Floor No</th>
                            <th scope="col">Bed No</th>
                            <th scope="col">Cost</th>
                            <th scope="col">Active</th>
                          </tr>
                        </thead>
                        <tbody id="tdata">
                        </tbody>
                    </table>
                        </div>
                        <div class="col-1"></div>
                    </div>
                </div>
            </div>
        </div>
        <script>
        function disp(){
        document.getElementById("open").style.display="block";
        }

            async function bookRoom(){
            var requestOptions = {
  method: 'POST',
  redirect: 'follow'
};
 var requestOptions1 = {
  method: 'GET',
  redirect: 'follow'
};
            document.getElementById("open").style.display="none";
            console.log("button clicked");
             let bedId=document.getElementById("mySelect").value;
             console.log(bedId);
             let fn  = document.getElementById("fname").value;
             let ln = document.getElementById("lname").value;
             let mn  = document.getElementById("mobileno").value;
             let email  = document.getElementById("email").value;
             let dob  = document.getElementById("dob").value;
      var t = JSON.stringify({
              "id" : 0,
  "firstName" : fn,
  "lastName" : ln,
  "mobileNo" : mn,
  "email" : email,
  "dob" : dob,
  "isActive" : true
         });
             var requestOptions5 = {
  method: 'POST',
  body: t,
  redirect: 'follow'
};
          await fetch(`http://localhost:8080/PG/userdetails`, requestOptions5)
const a=await fetch(`http://localhost:8080/PG/searchUser?email=${email}`, requestOptions1)
const userId=await a.json();
console.log(userId);
await fetch(`http://localhost:8080/PG/booking?userId=${userId}&bedId=${bedId}`,requestOptions5)
            }

            async function load() {
                const response1 = await fetch("http://localhost:8080/PG/booking")
            let data = await response1.json();
            let i=0;
            let c=document.createElement("tr");
            var td0 = document.createElement("td");
            var td1 = document.createElement("td");
            var td2 = document.createElement("td");
            var td3 = document.createElement("td");
            var td4 = document.createElement("td");
            var td5 = document.createElement("td");
            var td6=document.createElement("td");
            var txt="";
             for(i=0;i<data.length;i++){
                c=document.createElement("tr");
                td0 = document.createElement("td");
                td1 = document.createElement("td");
                td2 = document.createElement("td");
                td3 = document.createElement("td");
                td4 = document.createElement("td");
                td5 = document.createElement("td");
                td6=document.createElement("td");
                txt="";
                 txt =i+1;
                 td0.innerHTML=txt;
                 txt=""; 
                 txt =data[i]['email'];
                 td1.innerHTML=txt;
                 txt="";
                 txt =data[i]['roomNo'];
                 td2.innerHTML=txt;
                 txt="";
                 txt =data[i]['floorNo'];
                 td3.innerHTML=txt;
                 txt="";
                 txt =data[i]['bedNo'];
                 td4.innerHTML=txt;
                 txt="";
                  txt =data[i]['cost'];
                 td5.innerHTML=txt;
                 txt="";
                 txt=data[i]['isActive'];
                 if(txt==true){
                    txt="Yes";
                 }
                 else{
                    txt="No";
                 }
                 td6.innerHTML=txt;
                 c.appendChild(td0);
                  c.appendChild(td1);
                  c.appendChild(td2);
                  c.appendChild(td3);
                  c.appendChild(td4);
                  c.appendChild(td5);
                  c.appendChild(td6);
                 //console.log(txt);

                 document.getElementById("tdata").appendChild(c);
             }
            console.log(data);
           let  response2 = await fetch("http://localhost:8080/PG/vaccantroom")
            data = await response2.json();
            console.log(data);
             i=0;  
  var x = document.getElementById("mySelect");
 for(i=0;i<data.length;i++){
     var option = document.createElement("option");
     option.value =data[i]['bedId'] ;
    option.text = "Room:" +data[i]['roomNo'] +" Bed:"+ data[i]['bedNo'] ;
    x.add(option);

 }


            } 
        
        </script>
    </body>
</html>